<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LabCyber Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #5e22c3;
            margin: 0;
            padding: 0;
        }
        .dashboard-header {
            background: #5e22c3;
            color: white;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .bod {
            background: rgba(255, 255, 255, 0.98); /* 98% transparent white background */
            border: 2px solid #5e22c3; /* Add border */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
            padding: 20px;
            width: 65%;
            display: flex;
            flex-direction: column; /* Align children vertically */
            justify-content: flex-start; /* Align items to the top */
            margin-left: 1em;
            height: 368px; /* Reduced by 8% from 400px */
            position: relative;
            overflow: auto; /* Ensure content scrolls if it overflows */
        }
        .menu-items {
            background: rgba(255, 255, 255, 0.98); /* 98% transparent white background */
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 30%;
            display: inline-block;
            vertical-align: top;
            height: 368px; /* Reduced by 8% from 400px */
            border-left: 1em solid #5e22c3; /* Updated color */
            border-top: 0.25em solid #5e22c3; /* Updated color */
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* Align items to the top */
            align-items: flex-start; /* Align items to the left */
            text-align: left; /* Align text to the left */
            border-radius: 0; /* Removed rounded corners */
            overflow: auto; /* Prevent overflow of menu items */
        }
        .menu-items a, .attachment {
            display: block;
            padding: 10px;
            width: 100%;
            text-align: left; /* Align text to the left */
            text-decoration: none;
            color: black;
            transition: background 0.3s;
            cursor: pointer;
        }
        .menu-items a:hover, .attachment:hover {
            background: rgba(94, 34, 195, 0.45); /* Updated color */
            border-radius: 5px;
        }
        .input-group {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .form-section {
            display: none;
        }
        .upload-area {
            display: none;
            justify-content: center;
            align-items: center;
            height: 120px; /* Reduced height */
            font-size: 1.5em;
            color: #5e22c3; /* Updated color */
            border: 2px dashed #5e22c3; /* Updated color */
            border-radius: 10px;
            background: rgba(94, 34, 195, 0.1); /* Updated color */
            margin-top: 20px; /* Aligned to the top */
        }
        button {
            cursor: pointer;
        }
        .submit-container {
            text-align: center;
            margin-top: 1em;
        }

        .bod.show-add-comment #addCommentForm {
            display: block;
            margin-top: auto;
        }

        /* Styling for the dropped file name display */
        #fileName {
            font-size: 1.2em;
            margin-top: 1em; /* 1em margin from the drop area */
            color: #5e22c3; /* Updated color */
            display: none; /* Hidden by default */
        }

        /* Styling for the file rename input */
        #fileRenameInput {
            margin-top: 1em;
            padding: 0.5em;
            font-size: 1em;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 5px;
            display: none; /* Hidden by default */
        }

        /* Styling for the Push Changes button */
        .submit-container button {
            width: 100%;
            background: #5e22c3; /* Updated color */
            max-height: 3.6em; /* Reduced height by 10% */
            text-align: center;
            font-size: 0.9em; /* Reduced font size by 10% */
            line-height: 2.6em; /* Adjusted line height to match new height */
            overflow: hidden;
            padding: 0; /* Remove any extra padding */
        }

        /* Add background to the Add Project div */
        #addProjectForm {
            padding: 2em; /* Retain padding for better spacing */
            border-radius: 10px; /* Optional: Retain rounded corners */
        }

        /* Remove background for the input and save div */
        #addProjectForm .input-group {
            padding: 0; /* Remove padding */
            margin-top: 0; /* Remove margin-top */
            align-items: flex-start; /* Align to the top */
        }

        /* Style for the floating container */
        .floating-container {
            position: relative;
            background: linear-gradient(145deg, #1a1a1a, #333333); /* Dark shiny background */
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.5); /* Add a shadow for a floating effect */
            overflow: hidden;
        }

        /* Allow the child elements to float over */
        .container.mt-4 {
            position: relative;
            z-index: 1; /* Ensure the content floats above the background */
        }

        /* Style for the parent container bb */
        .bb {
            position: relative;
            background: url('Fac.png') no-repeat center center; /* Set background to Fac.png */
            background-size: cover; /* Ensure the image covers the entire container */
            padding: 20px;
            overflow: hidden;
            border-radius: 0; /* Remove rounded corners */
            margin-bottom: 0; /* Ensure no space below the bb div */
        }

        .bb::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, rgba(0, 0, 0, 0.2), transparent, rgba(112, 61, 233, 0.5)); /* Dark blur effect on left and right corners */
            pointer-events: none; /* Ensure it doesn't interfere with interactions */
        }

        footer {
            margin-top: 0; /* Ensure no space above the footer */
            text-align: center;
        }

        /* Style for the Save button */
        .btn-primary {
            background-color: #5e22c3; /* Set background color to #5e22c3 */
            border-color: #5e22c3; /* Set border color to match */
        }

        .btn-primary:hover {
            background-color: #4a1b9f; /* Slightly darker shade for hover effect */
            border-color: #4a1b9f;
        }

        /* Style for the footer */
        footer {
            background-color: #5e22c3; /* Set background color to #5e22c3 */
            color: white; /* Set text color to white for contrast */
            margin-top: 0; /* Remove extra space above the footer */
            text-align: center;
            height:1.8em; /* Add padding for better spacing */
        }

        #summary {
            max-height: 210px; /* Limit the height of the summary section */
            overflow-y: auto; /* Enable vertical scrolling if content overflows */
            text-align: left; /* Align text to the left */
            padding: 10px;
            border: 1px solid #ccc; /* Optional: Add a border for better visibility */
            margin-bottom: 20px;
        }

        #summary h5 {
            margin: 0 0 10px 0; /* Add spacing below the title */
        }

        #summary p {
            margin: 5px 0; /* Add spacing between items */
            font-size: 0.9em; /* Scale down the font size for better fit */
        }
        .request-item {
            border: 1px solid #ccc; /* Add border */
            background: rgba(255, 255, 255, 0.49); /* 89% transparency */
            padding: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between; /* Align buttons to the far end */
            align-items: center; /* Center content vertically */
            overflow: hidden; /* Ensure no content overflows the request item */
        }
        #approvedList, #disapprovedList {
            max-height: 200px; /* Limit height for scrolling */
            overflow-y: auto; /* Enable vertical scrolling if content overflows */
        }

        /* Custom scrollbar styles */
        ::-webkit-scrollbar {
            width: 8px; /* Width of the scrollbar */
            height: 8px; /* Height of the scrollbar */
        }

        ::-webkit-scrollbar-thumb {
            background: #ccc; /* Light gray color for the scrollbar thumb */
            border-radius: 4px; /* Rounded corners for the scrollbar thumb */
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #aaa; /* Slightly darker gray on hover */
        }

        ::-webkit-scrollbar-track {
            background: #f4f4f4; /* Very light gray for the scrollbar track */
        }
    </style>
</head>
<body>
    <div class="dashboard-header d-flex align-items-center">
        <!-- <button class="btn btn-light">☰</button> -->
        <h4 class="m-0" style="margin-left: 10px;">Dashboard</h4>
        <div class="d-flex align-items-center ms-auto">
            <img src="Fac.png" alt="Admin" class="rounded-circle" width="40"> <!-- Updated profile image -->
            <span class="ms-2">CyberLab Admin</span>
        </div>
    </div>
    
    <div class="bb">
        <div class="container mt-4">
            <div class="row justify-content-center">
                <div class="col-4 menu-items">
                    <a onclick="showForm('addProjectForm')">➕ Add Project</a>
                    <a onclick="showForm('addMachineForm')">➕ Add Machine</a>
                    <a onclick="showForm('addEventForm')">➕ Add Event</a>
                    <div class="attachment" onclick="showUploadArea()">📎 Choose a file</div>
                    <a onclick="showForm('addCommentForm')">➕ Add Comment</a>
                    <a onclick="showForm('viewRequestDiv')">📄 View Request <span id="requestCount" class="badge bg-danger">4</span></a>
                    <a onclick="showForm('approvedRequests')">✅ View Approved</a>
                    <a onclick="showForm('disapprovedRequests')">❌ Disapproved</a>
                </div>
                <div class="col-7 bod">
                    <div id="summary" style="margin-bottom: 10px;"></div> <!--Summary section -->
                    <div id="addProjectForm" class="form-section" style="display: block;">
                        <h5 class="card-title">📁 Add Project</h5>
                        <div class="input-group">
                            <input type="text" id="projectInput" class="form-control" placeholder="Enter Project Name..." oninput="handleProjectInput()">
                            <button id="saveProjectButton" class="btn btn-primary" onclick="saveInput('projectInput', 'projectList')" disabled>Save</button>
                        </div>
                        <div style="margin-top: 10px;">
                            <h6>Select a Default Project:</h6>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultProject('Project 1')">Project 1</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultProject('Project 2')">Project 2</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultProject('Project 3')">Project 3</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultProject('Project 4')">Project 4</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultProject('Project 5')">Project 5</button>
                        </div>
                        <div id="projectList" style="margin-top: 20px;"></div>
                    </div>
                    <div id="addMachineForm" class="form-section">
                        <h5 class="card-title">🖥️ Add Machine</h5>
                        <div class="input-group">
                            <input type="text" id="machineInput" class="form-control" placeholder="Enter Machine Name..." oninput="handleMachineInput()">
                            <button id="saveMachineButton" class="btn btn-primary" onclick="saveInput('machineInput', 'machineList')" disabled>Save</button>
                        </div>
                        <div style="margin-top: 10px;">
                            <h6>Select a Default Machine:</h6>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultMachine('Machine 1')">Machine 1</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultMachine('Machine 2')">Machine 2</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultMachine('Machine 3')">Machine 3</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultMachine('Machine 4')">Machine 4</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultMachine('Machine 5')">Machine 5</button>
                        </div>
                        <div id="machineList" style="margin-top: 20px;"></div>
                    </div>
                    
                    <div id="addEventForm" class="form-section">
                        <h5 class="card-title">📅 Add Event</h5>
                        <div class="input-group">
                            <input type="text" id="eventInput" class="form-control" placeholder="Enter Event Name..." oninput="handleEventInput()">
                            <button id="saveEventButton" class="btn btn-primary" onclick="saveInput('eventInput', 'eventList')" disabled>Save</button>
                        </div>
                        <div style="margin-top: 10px;">
                            <h6>Select a Default Event:</h6>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultEvent('Event 1')">Event 1</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultEvent('Event 2')">Event 2</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultEvent('Event 3')">Event 3</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultEvent('Event 4')">Event 4</button>
                            <button class="btn btn-outline-primary btn-sm" onclick="selectDefaultEvent('Event 5')">Event 5</button>
                        </div>
                        <div id="eventList" style="margin-top: 20px;"></div>
                    </div>
                    <div id="addCommentForm" class="form-section">
                        <h5 class="card-title">
                            💬 Add Comment <!-- Icon added beside the title -->
                        </h5>
                        <div class="input-group" style="margin-top: 20px;">
                            <input type="text" id="commentInput" class="form-control" placeholder="Enter Comment...">
                            <button class="btn btn-primary" onclick="saveInput('commentInput', 'commentList')">Save</button>
                        </div>
                        <div id="commentList" style="margin-top: 20px;"></div> <!-- Container to display saved comments -->
                    </div>
                    <div id="uploadArea" class="upload-area" onclick="triggerFileInput()" ondrop="handleFileDrop(event)" ondragover="allowFileDrop(event)">
                        Drop or Select (pdf/docx)
                    </div>
                    <input type="file" id="fileInput" style="display: none;" accept=".pdf,.docx" onchange="handleFileSelect(event)">
                    <div id="fileName" style="display: none;"></div> <!-- Display the dropped file name here -->
                    <input type="text" id="fileRenameInput" placeholder="Rename this file" onblur="validateFileName()" style="display: none;">
                    <button id="updateFileNameButton" class="btn btn-primary mt-2" onclick="updateFileName()" style="display: none;">Update Name</button>
                    <div id="filePreview" style="margin-top: 10px; display: none; text-align: center;">
                        <p><strong>File Preview:</strong></p>
                        <div id="previewContent" style="border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow: auto;"></div>
                    </div>
                    <div id="viewRequestDiv" class="form-section" style="display: none;">
                        <h5 class="card-title">📄 View Requests</h5>
                        <div class="request-item">
                            <p>@UserNameOne Is Requesting...</p>
                            <div>
                                <span class="text-success" style="cursor: pointer;" onclick="handleApprove(this)">Approve</span> | 
                                <span class="text-danger" style="cursor: pointer;" onclick="handleDecline(this)">Decline</span>
                            </div>
                        </div>
                        <div class="request-item">
                            <p>@UserNameTwo Is Requesting...</p>
                            <div>
                                <span class="text-success" style="cursor: pointer;" onclick="handleApprove(this)">Approve</span> | 
                                <span class="text-danger" style="cursor: pointer;" onclick="handleDecline(this)">Decline</span>
                            </div>
                        </div>
                        <!-- Add more request items as needed -->
                    </div>

                    <div id="approvedRequests" class="form-section" style="display: none;">
                        <h5 class="card-title">✅ Approved Requests</h5>
                        <div id="approvedList">
                            <!-- Approved requests will appear here without any buttons -->
                        </div>
                    </div>

                    <div id="disapprovedRequests" class="form-section" style="display: none;">
                        <h5 class="card-title">❌ Disapproved Requests</h5>
                        <div id="disapprovedList">
                            <!-- Disapproved requests will appear here dynamically -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="submit-container">
                <button id="pushCommitButton" class="btn btn-lg btn-primary" disabled>Push Commit</button>
            </div>
        </div>
    </div>
    <footer class="text-center mt-4">
        <p>All rights reserved CyberLab 2025</p>
    </footer>

    <script>
        function showForm(formId) {
            document.querySelectorAll('.form-section').forEach(section => {
                section.style.display = 'none';
            });

            // Hide file-related elements when switching to other forms
            document.getElementById('fileName').style.display = 'none';
            document.getElementById('fileRenameInput').style.display = 'none';
            document.getElementById('updateFileNameButton').style.display = 'none';
            document.getElementById('filePreview').style.display = 'none'; // Hide the file preview container

            // Show the selected form
            document.getElementById(formId).style.display = 'block';

            // Add class to bod to ensure Add Comment form is at the bottom
            const bod = document.querySelector('.bod');
            if (formId === 'addCommentForm') {
                bod.classList.add('show-add-comment');

                // Generate the summary
                const summaryDiv = document.getElementById('summary');
                summaryDiv.innerHTML = '<h5>Summary</h5>'; // Add the "Summary" title

                // Collect values from other lists
                const projectList = document.getElementById('projectList');
                const machineList = document.getElementById('machineList');
                const eventList = document.getElementById('eventList');
                const commentList = document.getElementById('commentList');

                // Append saved values to the summary
                if (projectList.children.length > 0) {
                    summaryDiv.innerHTML += '<p><strong>Projects:</strong></p>';
                    Array.from(projectList.children).forEach(item => {
                        summaryDiv.innerHTML += `<p>- ${item.querySelector('span').textContent}</p>`;
                    });
                }

                if (machineList.children.length > 0) {
                    summaryDiv.innerHTML += '<p><strong>Machines:</strong></p>';
                    Array.from(machineList.children).forEach(item => {
                        summaryDiv.innerHTML += `<p>- ${item.querySelector('span').textContent}</p>`;
                    });
                }

                if (eventList.children.length > 0) {
                    summaryDiv.innerHTML += '<p><strong>Events:</strong></p>';
                    Array.from(eventList.children).forEach(item => {
                        summaryDiv.innerHTML += `<p>- ${item.querySelector('span').textContent}</p>`;
                    });
                }

                if (commentList.children.length > 0) {
                    summaryDiv.innerHTML += '<p><strong>Comments:</strong></p>';
                    Array.from(commentList.children).forEach(item => {
                        summaryDiv.innerHTML += `<p>- ${item.querySelector('span').textContent}</p>`;
                    });
                }
            } else {
                bod.classList.remove('show-add-comment');
                document.getElementById('summary').innerHTML = ''; // Clear the summary when not in Add Comment form
            }

            // Hide the upload area, file name, and rename input for other forms
            document.getElementById('uploadArea').style.display = 'none';
            document.getElementById('fileName').style.display = 'none';
            document.getElementById('fileRenameInput').style.display = 'none';
        }

        function showUploadArea() {
            document.querySelectorAll('.form-section').forEach(section => {
                section.style.display = 'none';
            });

            // Show the upload area
            document.getElementById('uploadArea').style.display = 'flex';
            document.getElementById('fileName').style.display = 'block';
            document.getElementById('fileRenameInput').style.display = 'block';
            document.getElementById('filePreview').style.display = 'block'; // Show the file preview container

            // Remove class from bod to ensure Add Comment form is not at the bottom
            const bod = document.querySelector('.bod');
            bod.classList.remove('show-add-comment');
            document.getElementById('summary').innerHTML = ''; // Clear the summary when not in Add Comment form
        }

        function saveInput(inputId, listId) {
            const input = document.getElementById(inputId);
            const list = document.getElementById(listId);
            const saveButton = input.nextElementSibling; // Get the Save button next to the input

            if (input.value.trim() !== '') {
                const listItem = document.createElement('div');
                listItem.innerHTML = `<span>${input.value}</span> <button class="btn btn-sm btn-danger" onclick="removeItem(this)">Remove</button>`;
                list.appendChild(listItem);
                input.value = '';

                // Disable only the Save button for this input
                saveButton.disabled = true;

                // Update the summary if the comment is being added
                if (listId === 'commentList') {
                    const summaryDiv = document.getElementById('summary');
                    if (!summaryDiv.innerHTML.includes('<p><strong>Comments:</strong></p>')) {
                        summaryDiv.innerHTML += '<p><strong>Comments:</strong></p>';
                    }
                    summaryDiv.innerHTML += `<p>- ${listItem.querySelector('span').textContent}</p>`;
                }

                // Check if all required items are added
                checkRequiredItems();
            }
        }

        function removeItem(button) {
            const listItem = button.parentElement;
            const list = listItem.parentElement;
            const inputId = list.id.replace('List', 'Input'); // Derive input ID from list ID
            const input = document.getElementById(inputId);
            const saveButton = input.nextElementSibling; // Get the Save button next to the input

            // Remove the item from the list
            listItem.remove();

            // Enable the Save button if the list is empty
            if (list.children.length === 0) {
                saveButton.disabled = false;
            }

            // If the item is from the comment list, remove it from the summary
            if (list.id === 'commentList') {
                const summaryDiv = document.getElementById('summary');
                const commentText = listItem.querySelector('span').textContent;

                // Find and remove the corresponding comment in the summary
                const summaryComments = Array.from(summaryDiv.querySelectorAll('p'));
                summaryComments.forEach((summaryItem) => {
                    if (summaryItem.textContent === `- ${commentText}`) {
                        summaryItem.remove();
                    }
                });

                // If no comments remain in the summary, remove the "Comments" header
                if (!summaryDiv.innerHTML.includes('<p>-')) {
                    const commentsHeader = summaryDiv.querySelector('p strong');
                    if (commentsHeader && commentsHeader.textContent === 'Comments:') {
                        commentsHeader.parentElement.remove();
                    }
                }
            }

            // Check if all required items are added
            checkRequiredItems();
        }

        function checkRequiredItems() {
            const projectList = document.getElementById('projectList').children.length > 0;
            const machineList = document.getElementById('machineList').children.length > 0;
            const eventList = document.getElementById('eventList').children.length > 0;
            const commentList = document.getElementById('commentList').children.length > 0;

            const pushCommitButton = document.getElementById('pushCommitButton');
            if (projectList && machineList && eventList && commentList) {
                pushCommitButton.disabled = false; // Enable the button
            } else {
                pushCommitButton.disabled = true; // Disable the button
            }
        }

        let currentFileExtension = '';

        function sanitizeFileName(fileName) {
            return fileName.replace(/[^a-zA-Z0-9.]/g, '_').replace(/\s+/g, '_'); // Replace non-alphanumeric characters and spaces with '_'
        }

        function handleFileDrop(event) {
            event.preventDefault();
            const file = event.dataTransfer.files[0];
            handleFile(file, false);
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            handleFile(file, true);
        }

        function handleFile(file, isFromChooseFile) {
            const fileNameDiv = document.getElementById('fileName');
            const fileRenameInput = document.getElementById('fileRenameInput');
            const updateButton = document.getElementById('updateFileNameButton');
            const filePreview = document.getElementById('filePreview');
            const previewContent = document.getElementById('previewContent');

            if (file) {
                const allowedExtensions = ['pdf', 'docx', 'jpg', 'jpeg', 'png', 'gif', 'txt'];
                const fileExtension = file.name.split('.').pop().toLowerCase();

                if (!allowedExtensions.includes(fileExtension)) {
                    alert('Invalid file type. Please upload a PDF, DOCX, image, or text file.');
                    return;
                }

                currentFileExtension = fileExtension; // Store the file extension
                const sanitizedFileName = sanitizeFileName(file.name);
                fileNameDiv.textContent = `File: ${sanitizedFileName}`;
                fileNameDiv.style.display = 'block'; // Show the file name
                fileRenameInput.value = sanitizedFileName;
                fileRenameInput.style.display = 'block'; // Show the rename input

                // Only show the update button if the file is selected via "Choose File"
                updateButton.style.display = isFromChooseFile ? 'inline-block' : 'none';

                // Generate a preview
                filePreview.style.display = 'block'; // Show the preview container
                previewContent.innerHTML = ''; // Clear previous preview

                if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {
                    // Image preview
                    const img = document.createElement('img');
                    img.src = URL.createObjectURL(file);
                    img.style.maxWidth = '100%';
                    img.style.maxHeight = '150px';
                    previewContent.appendChild(img);
                } else if (fileExtension === 'txt') {
                    // Text file preview
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const textPreview = document.createElement('pre');
                        textPreview.textContent = e.target.result;
                        textPreview.style.whiteSpace = 'pre-wrap';
                        textPreview.style.textAlign = 'left';
                        previewContent.appendChild(textPreview);
                    };
                    reader.readAsText(file);
                } else {
                    // For unsupported previews (e.g., PDF, DOCX)
                    previewContent.innerHTML = '<p>Preview not available for this file type.</p>';
                }
            }
        }

        function allowFileDrop(event) {
            event.preventDefault();
        }

        function triggerFileInput() {
            document.getElementById('fileInput').click();
        }

        function validateFileName() {
            const fileRenameInput = document.getElementById('fileRenameInput');
            const sanitizedFileName = sanitizeFileName(fileRenameInput.value); // Sanitize the file name
            if (!sanitizedFileName.endsWith(`.${currentFileExtension}`)) {
                fileRenameInput.value = `${sanitizedFileName}.${currentFileExtension}`;
            } else {
                fileRenameInput.value = sanitizedFileName;
            }
        }

        function updateFileName() {
            const fileRenameInput = document.getElementById('fileRenameInput');
            const fileNameDiv = document.getElementById('fileName');
            validateFileName(); // Ensure the name is sanitized and ends with the correct extension
            fileNameDiv.textContent = `File: ${fileRenameInput.value}`;
        }

        function handleApprove(element) {
            const requestItem = element.parentElement.parentElement; // Get the request item div
            const approvedList = document.getElementById('approvedList');
            const buttonsDiv = requestItem.querySelector('div'); // Find the buttons container
            if (buttonsDiv) buttonsDiv.remove(); // Remove the buttons
            approvedList.appendChild(requestItem); // Move the request item to the approved list
            updateRequestCount(); // Update the request count
        }

        function handleDecline(element) {
            const requestItem = element.parentElement.parentElement; // Get the request item div
            const disapprovedList = document.getElementById('disapprovedList');
            const buttonsDiv = requestItem.querySelector('div'); // Find the buttons container
            if (buttonsDiv) buttonsDiv.innerHTML = '<span class="text-success" style="cursor: pointer;" onclick="handleApprove(this)">Approve</span>'; // Replace with only "Approve" button
            disapprovedList.appendChild(requestItem); // Move the request item to the disapproved list
            updateRequestCount(); // Update the request count
        }

        function updateRequestCount() {
            const requestCount = document.querySelectorAll('#viewRequestDiv .request-item').length;
            document.getElementById('requestCount').textContent = requestCount;
        }

        // Call updateRequestCount on page load to initialize the count
        document.addEventListener('DOMContentLoaded', updateRequestCount);

        function handleProjectInput() {
            const projectInput = document.getElementById('projectInput');
            const saveButton = document.getElementById('saveProjectButton');
            const projectList = document.getElementById('projectList');

            // Clear any existing project if the user starts typing
            if (projectInput.value.trim() !== '') {
                projectList.innerHTML = ''; // Clear the project list
                saveButton.disabled = false; // Enable the Save button
            } else {
                saveButton.disabled = true; // Disable the Save button if input is empty
            }
        }

        function selectDefaultProject(projectName) {
            const projectInput = document.getElementById('projectInput');
            const saveButton = document.getElementById('saveProjectButton');
            const projectList = document.getElementById('projectList');

            // Clear the input field and project list
            projectInput.value = '';
            projectList.innerHTML = '';

            // Add the selected project to the list
            const listItem = document.createElement('div');
            listItem.innerHTML = `<span>${projectName}</span> <button class="btn btn-sm btn-danger" onclick="removeItem(this)">Remove</button>`;
            projectList.appendChild(listItem);

            // Disable the Save button
            saveButton.disabled = true;
        }

        function handleMachineInput() {
            const machineInput = document.getElementById('machineInput');
            const saveButton = document.getElementById('saveMachineButton');
            const machineList = document.getElementById('machineList');

            // Clear any existing machine if the user starts typing
            if (machineInput.value.trim() !== '') {
                machineList.innerHTML = ''; // Clear the machine list
                saveButton.disabled = false; // Enable the Save button
            } else {
                saveButton.disabled = true; // Disable the Save button if input is empty
            }
        }

        function selectDefaultMachine(machineName) {
            const machineInput = document.getElementById('machineInput');
            const saveButton = document.getElementById('saveMachineButton');
            const machineList = document.getElementById('machineList');

            // Clear the input field and machine list
            machineInput.value = '';
            machineList.innerHTML = '';

            // Add the selected machine to the list
            const listItem = document.createElement('div');
            listItem.innerHTML = `<span>${machineName}</span> <button class="btn btn-sm btn-danger" onclick="removeItem(this)">Remove</button>`;
            machineList.appendChild(listItem);

            // Disable the Save button
            saveButton.disabled = true;
        }

        function handleEventInput() {
            const eventInput = document.getElementById('eventInput');
            const saveButton = document.getElementById('saveEventButton');
            const eventList = document.getElementById('eventList');

            // Clear any existing event if the user starts typing
            if (eventInput.value.trim() !== '') {
                eventList.innerHTML = ''; // Clear the event list
                saveButton.disabled = false; // Enable the Save button
            } else {
                saveButton.disabled = true; // Disable the Save button if input is empty
            }
        }

        function selectDefaultEvent(eventName) {
            const eventInput = document.getElementById('eventInput');
            const saveButton = document.getElementById('saveEventButton');
            const eventList = document.getElementById('eventList');

            // Clear the input field and event list
            eventInput.value = '';
            eventList.innerHTML = '';

            // Add the selected event to the list
            const listItem = document.createElement('div');
            listItem.innerHTML = `<span>${eventName}</span> <button class="btn btn-sm btn-danger" onclick="removeItem(this)">Remove</button>`;
            eventList.appendChild(listItem);

            // Disable the Save button
            saveButton.disabled = true;
        }

        function removeItem(button) {
            const listItem = button.parentElement;
            const list = listItem.parentElement;
            const inputId = list.id.replace('List', 'Input'); // Derive input ID from list ID
            const input = document.getElementById(inputId);
            const saveButton = input.nextElementSibling; // Get the Save button next to the input

            // Remove the item from the list
            listItem.remove();

            // Enable the Save button if the list is empty
            if (list.children.length === 0) {
                saveButton.disabled = false;
            }

            // If the item is from the comment list, remove it from the summary
            if (list.id === 'commentList') {
                const summaryDiv = document.getElementById('summary');
                const commentText = listItem.querySelector('span').textContent;

                // Find and remove the corresponding comment in the summary
                const summaryComments = Array.from(summaryDiv.querySelectorAll('p'));
                summaryComments.forEach((summaryItem) => {
                    if (summaryItem.textContent === `- ${commentText}`) {
                        summaryItem.remove();
                    }
                });

                // If no comments remain in the summary, remove the "Comments" header
                if (!summaryDiv.innerHTML.includes('<p>-')) {
                    const commentsHeader = summaryDiv.querySelector('p strong');
                    if (commentsHeader && commentsHeader.textContent === 'Comments:') {
                        commentsHeader.parentElement.remove();
                    }
                }
            }

            // Check if all required items are added and update the button state
            checkRequiredItems();
        }
    </script>
</body>
</html>
